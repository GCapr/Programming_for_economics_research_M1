<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>5B.2 Survey Programming | ProTools ER1</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Fira+Code:wght@400;500&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .protected-content { -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
    .code-tooltip { position: relative; cursor: help; border-bottom: 1px dotted #888; text-decoration: none; }
    .tooltip-popup { position: fixed; background: #1f2937; color: white; padding: 0.5rem 0.75rem; border-radius: 6px; font-size: 0.75rem; white-space: normal; max-width: 300px; opacity: 0; pointer-events: none; transition: opacity 0.15s ease-in-out; z-index: 10000; }
    .tooltip-popup.visible { opacity: 1; }
  </style>
</head>
<body>
  <div id="password-overlay" class="password-overlay">
    <div class="password-modal">
      <h2>ProTools ER1</h2>
      <p>Programming Tools for Empirical Research</p>
      <p style="font-size: 0.9rem; color: #666; margin-bottom: 1.5rem;">Please enter the course password to access the materials.</p>
      <input type="password" id="password-input" placeholder="Enter password" autocomplete="off">
      <button id="password-submit">Access Course</button>
      <p id="password-error" style="color: #e53e3e; font-size: 0.85rem; margin-top: 1rem; display: none;">Incorrect password. Please try again.</p>
    </div>
  </div>

  <div class="page-wrapper protected-content">
    <aside class="sidebar">
      <a href="../index.html" class="sidebar-logo">ProTools ER1</a>
      <span class="sidebar-subtitle">Programming Tools for Empirical Research</span>
      <nav>
        <ul>
          <li><a href="../index.html"><span class="welcome-icon">üè†</span> Welcome</a></li>
          <li><a href="05-data-analysis.html"><span class="module-number">5</span> Data Analysis</a></li>
          <li><a href="05a-data-simulation.html"><span class="module-number">5A</span> Data Simulation</a></li>
          <li>
            <a href="05b-experiments.html"><span class="module-number">5B</span> Coding for Experiments</a>
            <ul class="sub-nav">
              <li><a href="05b1-power-analysis.html">Power Analysis</a></li>
              <li class="active"><a href="05b2-survey-programming.html">Survey Programming</a></li>
              <li><a href="05b3-randomization.html">Randomization</a></li>
              <li><a href="05b4-balance-checks.html">Balance Checks</a></li>
            </ul>
          </li>
          <li><a href="06-causal-inference.html"><span class="module-number">6</span> Causal Inference</a></li>
          <li><a href="07-estimation.html"><span class="module-number">7</span> Estimation Methods</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <div class="content">
        <nav class="breadcrumb" style="margin-bottom: 1rem; font-size: 0.9rem; color: #666;">
          <a href="05b-experiments.html">5B Experiments</a> &raquo; Survey Programming
        </nav>

        <div class="module-header">
          <h1>5B.2 &nbsp;Survey Programming</h1>
          <div class="module-meta">
            <span>~2 hours</span>
            <span>Qualtrics, Prolific, URLs</span>
          </div>
        </div>

        <div class="toc">
          <h3>Table of Contents</h3>
          <ul>
            <li><a href="#qualtrics-basics">Qualtrics Basics</a></li>
            <li><a href="#url-parameters">URL Parameters for Treatment Assignment</a></li>
            <li><a href="#prolific-integration">Prolific Integration</a></li>
            <li><a href="#embedded-data">Embedded Data and Randomization</a></li>
          </ul>
        </div>

        <h2 id="qualtrics-basics">Qualtrics Basics</h2>

        <p>
          Qualtrics is the most common survey platform in academic research. You can build surveys through the visual interface or import them programmatically.
        </p>

        <h3>Key Features for Experiments</h3>

        <ul>
          <li><strong>Branch logic:</strong> Show different questions/treatments based on responses or embedded data</li>
          <li><strong>Embedded data:</strong> Store variables passed via URL (treatment assignment, participant IDs)</li>
          <li><strong>Randomization:</strong> Built-in randomizer for within-survey treatment assignment</li>
          <li><strong>Piped text:</strong> Display dynamic content based on previous responses</li>
          <li><strong>Quotas:</strong> Control how many participants see each condition</li>
        </ul>

        <h2 id="url-parameters">URL Parameters for Treatment Assignment</h2>

        <p>
          The most reliable way to assign treatments is through URL parameters. When participants click a link with embedded parameters, Qualtrics captures those values.
        </p>

        <h3>URL Structure</h3>

        <pre style="background: #1a202c; color: #e2e8f0; padding: 1rem; border-radius: 8px; overflow-x: auto;"><code><span style="color: #68d391;"># Base survey URL with parameters</span>
https://yourschool.qualtrics.com/jfe/form/SV_XXXX?treatment=1&pid=ABC123

<span style="color: #68d391;"># Parameters:</span>
<span style="color: #f6ad55;">treatment=1</span>    <span style="color: #68d391;"># Treatment condition (e.g., 0=control, 1=treatment)</span>
<span style="color: #f6ad55;">pid=ABC123</span>    <span style="color: #68d391;"># Participant ID from recruitment platform</span>
<span style="color: #f6ad55;">source=prolific</span> <span style="color: #68d391;"># Track recruitment source</span></code></pre>

        <h3>Setting Up Embedded Data in Qualtrics</h3>

        <ol>
          <li>Go to <strong>Survey Flow</strong></li>
          <li>Add an <strong>Embedded Data</strong> element at the top</li>
          <li>Add fields matching your URL parameters: <code>treatment</code>, <code>pid</code></li>
          <li>Leave values blank (they'll be filled from URL)</li>
        </ol>

        <h3>Using Embedded Data for Branching</h3>

        <p>In Survey Flow, add a <strong>Branch</strong> that checks the embedded data:</p>

        <pre style="background: #1a202c; color: #e2e8f0; padding: 1rem; border-radius: 8px;"><code>If treatment = 1
  ‚Üí Show Treatment Block
If treatment = 0
  ‚Üí Show Control Block</code></pre>

        <h2 id="prolific-integration">Prolific Integration</h2>

        <p>
          <a href="https://www.prolific.co" target="_blank">Prolific</a> is a participant recruitment platform that provides high-quality respondents for online experiments. Integration with Qualtrics involves:
        </p>

        <h3>1. Passing Prolific IDs to Qualtrics</h3>

        <p>Prolific automatically appends participant info to your survey URL. Configure your study to include:</p>

        <pre style="background: #1a202c; color: #e2e8f0; padding: 1rem; border-radius: 8px;"><code><span style="color: #68d391;"># Your survey URL in Prolific:</span>
https://yourschool.qualtrics.com/jfe/form/SV_XXXX?PROLIFIC_PID={{%PROLIFIC_PID%}}&STUDY_ID={{%STUDY_ID%}}&SESSION_ID={{%SESSION_ID%}}</code></pre>

        <h3>2. Redirecting Back to Prolific</h3>

        <p>At survey end, redirect participants to Prolific's completion URL:</p>

        <pre style="background: #1a202c; color: #e2e8f0; padding: 1rem; border-radius: 8px;"><code><span style="color: #68d391;"># End of survey redirect URL (in Qualtrics):</span>
https://app.prolific.co/submissions/complete?cc=XXXXXXXX

<span style="color: #68d391;"># The completion code (cc) is provided by Prolific for your study</span></code></pre>

        <h3>3. Python Script for Pre-Assigning Treatments</h3>

        <div class="code-tabs">
          <div class="tab-buttons">
            <button class="tab-button active" data-lang="python">Python</button>
          </div>
          <div class="tab-content active" data-lang="python">
<pre><code><span class="code-comment"># Python: Generate treatment-assigned URLs for Prolific</span>
<span class="code-keyword">import</span> pandas <span class="code-keyword">as</span> pd
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np

<span class="code-comment"># Base survey URL</span>
base_url = <span class="code-string">"https://yourschool.qualtrics.com/jfe/form/SV_XXXX"</span>

<span class="code-comment"># List of participant IDs (from Prolific or pre-registration)</span>
participant_ids = [<span class="code-string">"P001"</span>, <span class="code-string">"P002"</span>, <span class="code-string">"P003"</span>, ...]

<span class="code-comment"># Random assignment</span>
np.random.seed(42)
n = len(participant_ids)
treatments = np.random.choice([0, 1], size=n)

<span class="code-comment"># Generate personalized URLs</span>
<span class="code-tooltip" data-tip="Each participant gets a unique URL with their ID and assigned treatment">urls = [
    f<span class="code-string">"{base_url}?pid={pid}&treatment={t}"</span>
    <span class="code-keyword">for</span> pid, t <span class="code-keyword">in</span> zip(participant_ids, treatments)
]</span>

<span class="code-comment"># Save assignment for analysis</span>
df = pd.DataFrame({
    <span class="code-string">'participant_id'</span>: participant_ids,
    <span class="code-string">'treatment'</span>: treatments,
    <span class="code-string">'survey_url'</span>: urls
})
df.to_csv(<span class="code-string">'treatment_assignment.csv'</span>, index=False)</code></pre>
          </div>
        </div>

        <h2 id="embedded-data">Embedded Data and Randomization</h2>

        <h3>Within-Survey Randomization</h3>

        <p>If you prefer to randomize within Qualtrics rather than via URLs:</p>

        <ol>
          <li>In Survey Flow, add a <strong>Randomizer</strong> element</li>
          <li>Set to "Evenly Present Elements"</li>
          <li>Add your treatment blocks as elements</li>
          <li>Store the assignment in an embedded data field for analysis</li>
        </ol>

        <div class="info-box warning">
          <div class="info-box-title">URL vs. Within-Survey Randomization</div>
          <p style="margin-bottom: 0;">
            <strong>URL-based</strong> (recommended): Pre-assign treatments, full control, easy to verify balance before launching.<br>
            <strong>Within-survey</strong>: Simpler setup, but harder to track who got what treatment before data download.
          </p>
        </div>

        <div class="citation">
          <div class="citation-title">Resources</div>
          <ul>
            <li><strong>Qualtrics Support:</strong> <a href="https://www.qualtrics.com/support/" target="_blank">Qualtrics Documentation</a></li>
            <li><strong>Prolific Researcher Guide:</strong> <a href="https://researcher-help.prolific.co/" target="_blank">Prolific Help Center</a></li>
          </ul>
        </div>

        <div class="nav-footer">
          <a href="05b1-power-analysis.html" class="nav-link prev">5B.1: Power Analysis</a>
          <a href="05b3-randomization.html" class="nav-link next">5B.3: Randomization</a>
        </div>
      </div>
    </main>
  </div>

  <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">Menu</button>
  <script src="../js/main.js"></script>
  <script src="../js/password-protection.js"></script>
</body>
</html>
